# 캠토리 (Camptory) - 캠핑장 추천 챗봇

## 🏕️ 프로젝트 소개

**캠토리(Camptory)**는 사용자의 질문에 맞춰 캠핑장 정보를 제공하고 추천해주는 대화형 AI 챗봇입니다. 자연어 질문을 이해하고, 사용자의 선호도(유료 캠핑장, 글램핑, 노지 캠핑 등)를 파악하여 맞춤형 답변을 생성합니다. 추천된 장소는 Tmap API와 연동된 인터랙티브 지도에 표시되며, 사용자의 현재 위치로부터 실시간 교통 상황이 반영된 경로를 확인할 수 있습니다.

이 프로젝트는 언어 모델과 RAG(Retrieval-Augmented Generation) 기술을 기반으로 하여, 특정 데이터에 기반한 정확하고 상세한 정보 제공을 목표로 합니다.

---

## ✨ 주요 기능

- **🤖 대화형 AI 챗봇**: 자연어 질문을 이해하고 캠핑 관련 정보를 제공합니다.
- **🔍 GraphRAG (검색 증강 생성)**: GraphDB를 사용하여 질문과 관련된 정확한 캠핑장 정보를 검색하고 답변을 생성합니다.
- **👍 동적 맞춤 추천**: 사용자의 선호도(유료, 글램핑, 노지 등)를 파악하여 그에 맞는 캠핑 스타일을 추천하는 2단계 대화 흐름을 갖추고 있습니다.
- **🗺️ 인터랙티브 지도**: 추천된 캠핑장의 위치를 Tmap 지도에 마커로 표시합니다.
- **🚗 실시간 교통정보 경로**: 사용자의 현재 위치(또는 기본 위치)로부터 추천된 장소까지의 자동차 경로를 실시간 교통정보에 따라 다른 색상으로 시각화합니다.
- **📱 반응형 UI**: 데스크톱(가로) 및 모바일(세로) 환경에 최적화된 UI를 제공하여 어떤 기기에서든 편리하게 사용할 수 있습니다.

---

## 🛠️ 기술 스택

- **Backend**: 
  - `Python`, `Flask`
  - `LangChain`, `LangGraph` (대화 흐름 및 AI 로직 관리)
- **Frontend**:
  - `HTML`, `CSS`, `JavaScript`
  - `Tmap API v2` (지도 및 경로 시각화)
- **AI/ML**:
  - **LLM**: `로컬 모델 finetuning` , `GPT-finetuning`
  - **Embedding Model**: `dragonkue/BGE-m3-ko` (RAG를 위한 텍스트 임베딩)
- **Database**:
  - `GraphRAG` (캠핑장 정보 저장을 위한 벡터 스토어)

---

## 📂 프로젝트 구조

```
TrailMate/
├── .env                  # 환경 변수 파일 (API 키 등)
├── requirements.txt      # Python 라이브러리 목록
├── web_page/
│   ├── app.py            # 메인 웹 서버
│   ├── config.py     
│   ├── naver_api.py      # 실시간 정보추출을 위한 네이버 검색 로직
|   ├── rag_components.py # LangGraph를 이용한 핵심 챗봇 로직
|   ├── services.py
|   ├── static/
│   │   └── style.css     # 웹 UI 스타일 시트
│   └── templates/
│       └── index.html    # 메인 프론트엔드 HTML 파일
└── data/

```

---

## 🧠 LangGraph 아키텍처

캠토리 챗봇은 LangGraph를 활용하여 복잡한 대화 흐름과 의사 결정을 효율적으로 관리합니다. 크게 두 가지의 그래프(워크플로우)로 구성되어 있으며, `server.py`에서 사용자의 대화 상태에 따라 적절한 그래프를 호출합니다.

### 1. 메인 워크플로우 (`main_app`)

사용자의 초기 질문을 분류하고, 일반적인 질문에는 직접 답변하며, 장소 추천 질문에는 추가적인 정보를 요청하는 역할을 합니다.

```
+-------------------+
|   User Question   |
+---------+---------+
          |
          v
+-------------------+
| classify_type     |
| (질문 유형 분류)  |
+---------+---------+
     |         |
     |         +--- "장소 추천" ---+
     |                             |
     v                             v
+-------------------+       +-------------------+
| generate_general  |       |  ask_preference   |
| (일반 답변 생성)  |       |  (캠핑 유형 요청) |
+---------+---------+       +---------+---------+
          |                           |
          v                           v
        (END)                       (END)
```

**노드 설명:**
- `classify_type`: 사용자의 질문을 '일반 캠핑' 또는 '장소 추천'으로 분류합니다.
- `generate_general`: '일반 캠핑' 질문에 대한 답변을 생성합니다.
- `ask_preference`: '장소 추천' 질문에 대해 사용자에게 원하는 캠핑 유형(유료, 글램핑, 노지 등)을 문의합니다.

### 2. 장소 추천 워크플로우 (`continuation_app`)

사용자가 캠핑 유형을 선택한 후, 해당 유형에 맞는 캠핑장을 검색하고 최종 추천 답변을 생성하는 역할을 합니다. RAG(검색 증강 생성)와 네이버 검색 API를 활용하여 관련 정보를 수집합니다.

```
                                +-------------------+
                                | User Response     |
                                | (캠핑 유형 선택)  |
                                +---------+---------+
                                          |
                                          v
                                +-------------------+
                                | classify_camping  |
                                | (캠핑 유형 분류)  |
                                +---------+---------+
                                 |        |        |
            +--- "유료캠핑장" ---+        |        +--- "오지/노지캠핑" ---+
            |                             |                                |
            |                      "글램핑/카라반"                         |
            |                             |                                |
            |                             |                                |
            |                             |                                |
            v                             v                                v
  +-------------------+       +----------------------+          +----------------------+
  | search_paid       |       |  search_glamping     |          |     search_ojee      |
  | (유료 캠핑장 검색)|       | (글램핑/카라반 검색) |          | (오지/노지 캠핑 검색)|
  +---------+---------+       +-----------+----------+          +---------+------------+
            |                             |                               |
            +-----------------------------+-------------------------------+
                                          |
                                          v
                              +-----------------------+
                              |   generate_location   |
                              | (장소 추천 답변 생성) |
                              +-----------+-----------+
                                          |
                                          v
                                        (END)
```

**노드 설명:**
- `classify_camping`: 사용자의 응답을 '유료캠핑장', '글램핑/카라반', '오지/노지캠핑' 중 하나로 분류합니다.
- `search_paid`, `search_glamping`, `search_ojee`: 분류된 캠핑 유형에 따라 ChromaDB 및 네이버 검색 API를 통해 관련 캠핑장 정보를 검색합니다.
- `generate_location`: 검색된 정보를 바탕으로 사용자에게 최종 캠핑장 추천 답변을 생성합니다.

이러한 두 가지 워크플로우의 유기적인 연동을 통해 캠토리 챗봇은 사용자의 다양한 질문에 대해 유연하고 정확한 답변을 제공할 수 있습니다.

**발표 자료**

### 시연영상
<video width="100%" controls>
  <source src="final/camptory_demo.mp4" type="video/mp4">
  브라우저가 비디오 태그를 지원하지 않습니다.
</video>


**📄 [전체 포스터 보기](final/camptory_trailmate_poster_0.pdf)**